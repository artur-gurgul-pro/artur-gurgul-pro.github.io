<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Artur Gurgul - iOS Architecture Patterns</title>
  <meta name="author" content="Artur Gurgul" />
  <meta name="description" content="The blog of Artur Gurgul" />
  
  <link rel="shortcut icon" href="/favicon.png">
  <link rel="alternate" type="application/atom+xml" title="Artur Gurgul" href="artur.gurgul.pro/atom.xml" />
  <link rel="stylesheet" href="/assets/css/all.css">
</head>
<body>
  <div class="container">
    <div class="sidebar">
      <nav>
  <h2 style="font-size: 20px;margin: 0px;">Hi. I'm <a href="/"> Artur Gurgul</a>,</h2>
   <h2 style="font-size: 15px;margin-top: -0.5em;">and this is my notepad.</h2>
  <hr class="hr-text" data-content="Contents"/>
  
  <ul id="blog-posts" class="posts">
    <!-- <li><span style="font-weight: bold; color: #3498db;">&raquo;</span><a href="/" style="font-weight: 600;">Selected</a></li> -->
  
    
    <li><span>&raquo;</span><a href="/software/vim.html"
      
      

      >Vim notes</a></li>
  
    
    <li><span>&raquo;</span><a href="/regex-notes.html"
      
      

      >Regex - notes</a></li>
  
    
    <li><span>&raquo;</span><a href="/recepies.html"
      
      

      >Recepies</a></li>
  
    
    <li><span>&raquo;</span><a href="/software/git-notes.html"
      
      

      >Git - notes</a></li>
  
    
    <li><span>&raquo;</span><a href="/linux/installation.html"
      
      

      >Linux installation</a></li>
  
    
    <li><span>&raquo;</span><a href="/programming/solid.html"
      
      

      >SOLID principles</a></li>
  
    
    <li><span>&raquo;</span><a href="/programming/bridging.html"
      
      

      >Bridging between languages</a></li>
  
    
    <li><span>&raquo;</span><a href="/programming/javascript-notes.html"
      
      

      >Javascript - notes</a></li>
  
    
    <li><span>&raquo;</span><a href="/swift/swift-notes.html"
      
      

      >Swift - notes</a></li>
  
    
    <li><span>&raquo;</span><a href="/swift/ios-architecture-patterns.html"
      
      
        style="font-weight: bold;"
      

      >iOS Architecture Patterns</a></li>
  
    
    <li><span>&raquo;</span><a href="/swift/xcode-modularisation.html"
      
      

      >Modularisation of an iOS app</a></li>
  
    
    <li><span>&raquo;</span><a href="/swift/threading.html"
      
      

      >Threading</a></li>
  
  </ul>
</nav>

    </div>

    <div class="scroll">
      <div class="content">
        <h1 class="title">iOS Architecture Patterns</h1>

<div id="post">
  <h3 id="remove-story-board-dependency">Remove story board dependency</h3>

<ol>
  <li>Remove <code class="language-plaintext highlighter-rouge">Main.storyboard</code> file</li>
  <li>Remove storyboard reference from <code class="language-plaintext highlighter-rouge">Info.plist</code> → In Scene Configuration find <code class="language-plaintext highlighter-rouge">Storyboard Name</code> and delete it</li>
  <li>Go to build settings and remove <code class="language-plaintext highlighter-rouge">UIKit MainStoryboard File Base Name</code> field</li>
  <li>Create a window in Scene Delegate</li>
</ol>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">scene</span><span class="p">(</span><span class="n">_</span> <span class="nv">scene</span><span class="p">:</span> <span class="kt">UIScene</span><span class="p">,</span>
           <span class="n">willConnectTo</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">UISceneSession</span><span class="p">,</span>
           <span class="n">options</span> <span class="nv">connectionOptions</span><span class="p">:</span> <span class="kt">UIScene</span><span class="o">.</span><span class="kt">ConnectionOptions</span><span class="p">)</span> <span class="p">{</span>
    
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">scene</span> <span class="o">=</span> <span class="p">(</span><span class="n">scene</span> <span class="k">as?</span> <span class="kt">UIWindowScene</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
    
    <span class="k">let</span> <span class="nv">window</span> <span class="o">=</span> <span class="kt">UIWindow</span><span class="p">(</span><span class="nv">windowScene</span><span class="p">:</span> <span class="n">scene</span><span class="p">)</span>
    <span class="n">window</span><span class="o">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="kt">ViewController</span><span class="p">()</span>
    <span class="n">window</span><span class="o">.</span><span class="nf">makeKeyAndVisible</span><span class="p">()</span>
    <span class="k">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">window</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="dependency-injection">Dependency injection</h2>

<!-- https://www.swiftbysundell.com/tips/testing-code-that-uses-static-apis/ -->

<p><a href="https://www.avanderlee.com/swift/dependency-injection/">Explanation of the code under this link</a></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">InjectionKey</span> <span class="p">{</span>
    <span class="kd">associatedtype</span> <span class="kt">Value</span>
    <span class="kd">static</span> <span class="k">var</span> <span class="nv">currentValue</span><span class="p">:</span> <span class="k">Self</span><span class="o">.</span><span class="kt">Value</span> <span class="p">{</span> <span class="k">get</span> <span class="k">set</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">InjectedValues</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="k">var</span> <span class="nv">current</span> <span class="o">=</span> <span class="kt">InjectedValues</span><span class="p">()</span>
    
    <span class="kd">static</span> <span class="kd">subscript</span><span class="o">&lt;</span><span class="kt">K</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">key</span><span class="p">:</span> <span class="kt">K</span><span class="o">.</span><span class="k">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">K</span><span class="o">.</span><span class="kt">Value</span> <span class="k">where</span> <span class="kt">K</span> <span class="p">:</span> <span class="kt">InjectionKey</span> <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="n">key</span><span class="o">.</span><span class="n">currentValue</span> <span class="p">}</span>
        <span class="k">set</span> <span class="p">{</span> <span class="n">key</span><span class="o">.</span><span class="n">currentValue</span> <span class="o">=</span> <span class="n">newValue</span> <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">static</span> <span class="kd">subscript</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span> <span class="nv">keyPath</span><span class="p">:</span> <span class="kt">WritableKeyPath</span><span class="o">&lt;</span><span class="kt">InjectedValues</span><span class="p">,</span> <span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">T</span> <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="n">current</span><span class="p">[</span><span class="nv">keyPath</span><span class="p">:</span> <span class="n">keyPath</span><span class="p">]</span> <span class="p">}</span>
        <span class="k">set</span> <span class="p">{</span> <span class="n">current</span><span class="p">[</span><span class="nv">keyPath</span><span class="p">:</span> <span class="n">keyPath</span><span class="p">]</span> <span class="o">=</span> <span class="n">newValue</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@propertyWrapper</span>
<span class="kd">struct</span> <span class="kt">Injected</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">keyPath</span><span class="p">:</span> <span class="kt">WritableKeyPath</span><span class="o">&lt;</span><span class="kt">InjectedValues</span><span class="p">,</span> <span class="kt">T</span><span class="o">&gt;</span>
    <span class="k">var</span> <span class="nv">wrappedValue</span><span class="p">:</span> <span class="kt">T</span> <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="kt">InjectedValues</span><span class="p">[</span><span class="n">keyPath</span><span class="p">]</span> <span class="p">}</span>
        <span class="k">set</span> <span class="p">{</span> <span class="kt">InjectedValues</span><span class="p">[</span><span class="n">keyPath</span><span class="p">]</span> <span class="o">=</span> <span class="n">newValue</span> <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">keyPath</span><span class="p">:</span> <span class="kt">WritableKeyPath</span><span class="o">&lt;</span><span class="kt">InjectedValues</span><span class="p">,</span> <span class="kt">T</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">keyPath</span> <span class="o">=</span> <span class="n">keyPath</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="define-dependency">Define dependency</h4>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">struct</span> <span class="kt">UsersRepositoryKey</span><span class="p">:</span> <span class="kt">InjectionKey</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="k">var</span> <span class="nv">currentValue</span><span class="p">:</span> <span class="kt">AnyUsersRepository</span> <span class="o">=</span> <span class="kt">UsersRepository</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">InjectedValues</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">usersRepository</span><span class="p">:</span> <span class="kt">AnyUsersRepository</span> <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">Self</span><span class="p">[</span><span class="kt">UsersRepositoryKey</span><span class="o">.</span><span class="k">self</span><span class="p">]</span> <span class="p">}</span>
        <span class="k">set</span> <span class="p">{</span> <span class="k">Self</span><span class="p">[</span><span class="kt">UsersRepositoryKey</span><span class="o">.</span><span class="k">self</span><span class="p">]</span> <span class="o">=</span> <span class="n">newValue</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">protocol</span> <span class="kt">AnyUsersRepository</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getUsers</span><span class="p">(</span><span class="n">_</span> <span class="nv">result</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">User</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span><span class="o">-&gt;</span><span class="kt">Void</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">UsersRepository</span><span class="p">:</span> <span class="kt">AnyUsersRepository</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getUsers</span><span class="p">(</span><span class="n">_</span> <span class="nv">result</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">User</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span><span class="o">-&gt;</span><span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">&lt;</span><span class="err">#</span><span class="kt">Implementation</span><span class="err">#</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@Injected</span><span class="p">(\</span><span class="o">.</span><span class="n">usersRepository</span><span class="p">)</span> <span class="k">var</span> <span class="nv">usersRepository</span><span class="p">:</span> <span class="kt">AnyUsersRepository</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">InjectedValues</span><span class="p">[\</span><span class="o">.</span><span class="n">usersRepository</span><span class="p">]</span> <span class="o">=</span> <span class="kt">MockedUsersRepository</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="model-view-controller">Model-View-Controller</h2>

<h4 id="clasic-version">Clasic version</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">View</code> and <code class="language-plaintext highlighter-rouge">Model</code> are linked together, so reusability is reduced.</li>
  <li>Note: Views in iOS apps are quite often reusable.</li>
</ul>

<p>
 <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="473px" height="186px" viewBox="-0.5 -0.5 473 186" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2023-11-07T18:34:22.657Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/22.0.3 Chrome/114.0.5735.289 Electron/25.8.4 Safari/537.36&quot; version=&quot;22.0.3&quot; etag=&quot;Iz-bp9UTBWzNTIIgo6GH&quot; type=&quot;device&quot;&gt;&lt;diagram name=&quot;Page-1&quot; id=&quot;xkBbz92YaXBT8ljpGPb4&quot;&gt;7VlbV6MwEP41fdQDoRf62Iu6D+6u53j29phCSrOmDCektvXXbwJJIQUrWmvr6hPky2RIMt98DKHljearK46T2VcICWshJ1y1vHELIdfv9uVFIWuNSChHIk5DjRXALX0gGnQ0uqAhSS1DAcAETWwwgDgmgbAwzDksbbMpMPupCY5IBbgNMKuiv2goZjnqo16BfyE0mpknu2bFc2yM9UrSGQ5hWYK8i5Y34gAiv5uvRoSp3TP7ko+7fKR3MzFOYtFkAMoH3GO20GvT8xJrs1gSyrXrJnAxgwhizC4KdMhhEYdEeXRkq7C5Bkgk6ErwLxFirQOJFwIkJGfI17/VoHPUMe0/2knWGK+s1lq3phCLETDg2fw8x+k6WD58mAoOd+TxHhMqpH2YRan5YUajWN4H8lFEDh8yPCHsBlIqKFgd94QLKqlwvWUwp2GY7YYxGGiXm47M5RAHd1G2YWaiMcSqN993tdlWKFNY8EBDOkkE5hHZUKsacXfDI5mBBOZEbp404YRhQe9t91hnQrSx00MHnON1ySABGou05PlGAdJAZzXyNaN1Tvct3smb3KFplWZWQBk363nqVXj6IwmxILVszUJTF9Tt0ExACJgrBpOUPuBJ5kRRTK9WeuwMW51xPekGCp8Bpw+yDzPNpJcTpwk/lBOyatWInJ59IS1lSqB6SmhHzrnj+8gK35l2/jzSFKwwJjCdppKrNhWeG/z2SYjUvho1GNfoTlWZalUsG3sQ/Wi/vn5Ykd4R1s4jOZ1+JnWjpG7vTOoz+Vrt+p0TSuNuJd4jucccGJNbuR1yO12nlLGtrVOxu8RzylTKfU9ILMff4jg9UIHwwjg2yCs9oI3sF6h5ny6LAtM1JrNScdl19s/E3hEFdkVFrq+9jm5u9FXeF/KqGkZdC1W2NFm7eG+ybGq4si53jyfLflWWU5WgziBQ4vZfqXOa4IDG0VBPatw+rGL3nijDUK/Xtsswbz/9XtcOeBU17x9fM9yyYBT68VE145i1nDmZKdHhiqjvRWeR1XRhxozPD7amStF/Qilc37wiTqK0M3Qshf8nJcunqrodJVx9wffuqjrUsas65LxhWece83TP1HWWRqOGGu3aGo1eV6PrLKtc2V+j2zUafYDzusZ0qB6ifQNBp/Tzi7uhKru7z9HkJ7fb8+0C7pTO0dzqQZr+OfPRZbrrvJ1My2bxfyePYvGbzLv4Bw==&lt;/diagram&gt;&lt;/mxfile&gt;" class="center-image">
  <g>
    <path d="M 171 14 L 31.05 14 L 31 115.76" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 31 121.76 L 27 113.76 L 31 115.76 L 35 113.77 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="10.999999999999998px">
      <text x="35.24" y="8.55">Update</text>
    </g>
    <path d="M 291 34 L 410.95 34 L 411 115.76" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 411 121.76 L 406.99 113.77 L 411 115.76 L 414.99 113.76 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="10.999999999999998px">
      <text x="367.87" y="29.55">Updates</text>
    </g>
    <rect x="171" y="4" width="120" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="11.999999999999998px">
      <text x="230.5" y="38.5">Controller</text>
    </g>
    <path d="M 91 124 L 90.95 49.05 L 162.76 49.01" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 168.76 49 L 160.77 53.01 L 162.76 49.01 L 160.76 45.01 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="10.999999999999998px">
      <text x="114.98" y="44.59">User Actions</text>
    </g>
    <path d="M 121 169 L 342.76 169" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 348.76 169 L 340.76 173 L 342.76 169 L 340.76 165 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="10.999999999999998px">
      <text x="256.82" y="164.55">Gets updated state</text>
    </g>
    <rect x="1" y="124" width="120" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="11.999999999999998px">
      <text x="60.5" y="158.5">View</text>
    </g>
    <path d="M 351 139 L 129.24 139" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 123.24 139 L 131.24 135 L 129.24 139 L 131.24 143 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="10.999999999999998px">
      <text x="256.29" y="133.55">Notifies</text>
    </g>
    <rect x="351" y="124" width="120" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="11.999999999999998px">
      <text x="410.5" y="158.5">Model</text>
    </g>
  </g>
</svg>
</p>

<h4 id="apple-version">Apple version</h4>

<p>
 <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="473px" height="187px" viewBox="-0.5 -0.5 473 187" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2023-11-07T18:35:04.577Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/22.0.3 Chrome/114.0.5735.289 Electron/25.8.4 Safari/537.36&quot; version=&quot;22.0.3&quot; etag=&quot;K1wkrmuddXaPyJl6GV6f&quot; type=&quot;device&quot;&gt;&lt;diagram name=&quot;Page-1&quot; id=&quot;i07ux6VTKLeM-OTNBLxs&quot;&gt;5ZhNU9swEIZ/TY5k/BHHzjEf0B5oywzTFo7CVhwVxeuRFZLw6yvZq9iOTYCEQEpPWK9Wa0n76kFxxx3PV18ESWffIKK841jRquNOOo5jB/2B+qOVNSpKKpRYsAi1UrhmjxRFC9UFi2hWC5QAXLK0LoaQJDSUNY0IAct62BR4/a0piWlDuA4Jb6q/WSRnhRo4fql/pSyemTfbZsVzYoJxJdmMRLCsSO55xx0LAFk8zVdjyvXumX0pxl080buZmKCJfMkApxjwQPgC14bzkmuzWBqptWMThJxBDAnh56U6ErBIIqozWqpVxlwCpEq0lfiHSrnGQpKFBCWpGYr1jR7UdTzTvsUkeWOyqrXW2JpCIsfAQeTzcy2rbxH18lEmBdzTp3tMqRzMYRal50c4ixP1HKpXUTV8xMkd5VeQMcmg1vFAhWTKCpdbAXMWRflumIAhptx05ClHJLyP8w0zE00g0b3FvuvNrpUyg4UIUcJDIomIKVZ30Cy4vbGROoAU5lTtnQoRlBPJHurZCR6EeBOHQ4dCkHUlIAWWyKyS+UoLKgAPtRP4Xa/IiYfaDZyq89RDkdO0KpMrpdyd7U51G079mUZE0la/5sVpK+t2ce5ASphrD9OMPZK7PIk2GS5YZfRGHW/Sbruh1mcg2KPqIxy9tL91spSELIlHOKky2zOu0YnpqtOCPlxRCZyqU5x2p2Aiq2sFWENT0zNM/jovlWYxITCdZsrBdXu81hC9k0DXoeQaTlpo1ORVK9vysXTF5A2O08+3FaKqZjkT3TATOQaKbOftWVSzxw4veE/AIfvMdHCPS4feTjqcKY/1A++EeNBveGCs9l0A52p7t21QP/dTxvnW1ul6XpA54/rI/EhposZfkyQ70v1jzzq+4KzhgJ7T+Aft44FdlldY2xhhVrm+9q3DD6j/gbBGQFpd36sycicgS8LX+I4p3hnxB9N60KR1/+NgHTRhnekjag1DjbxPzez+cZntP3Ojc3y/V7/RuYcRfN064E14PmjY5Bejy+dIvgPb7ZD/50jueNsk7w3ekeTmG8zHotzZA+X2UVHeFtl0y8EoN7fsE2G5bTfc8B0km7LPffW27VK8pFO96WfOS39Y7cl222qvaXkht/2gDvdT+rlujFtxCn4Z/t+B3rfeE+iqWX5eLupYfqV3z/8C&lt;/diagram&gt;&lt;/mxfile&gt;" class="center-image">
  <g>
    <path d="M 170.5 15 L 30.53 15 L 30.5 116.76" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 30.5 122.76 L 26.5 114.76 L 30.5 116.76 L 34.5 114.76 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="10.999999999999998px">
      <text x="34.74" y="8.55">Update</text>
    </g>
    <path d="M 290.5 20 L 410.53 20.05 L 410.5 116.76" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 410.5 122.76 L 406.5 114.76 L 410.5 116.76 L 414.5 114.77 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="10.999999999999998px">
      <text x="372.63" y="12.59">Updates</text>
    </g>
    <rect x="170.5" y="5" width="120" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="11.999999999999998px">
      <text x="230" y="39.5">Controller</text>
    </g>
    <path d="M 90.5 125 L 90.53 50.05 L 162.26 50.01" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 168.26 50 L 160.27 54.01 L 162.26 50.01 L 160.26 46.01 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="10.999999999999998px">
      <text x="114.55" y="43.59">User Actions</text>
    </g>
    <rect x="0.5" y="125" width="120" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="11.999999999999998px">
      <text x="60" y="159.5">View</text>
    </g>
    <path d="M 380.5 125 L 380.53 50.05 L 298.74 50" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 292.74 50 L 300.74 46.01 L 298.74 50 L 300.73 54.01 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="10.999999999999998px">
      <text x="371.55" y="42.18">Notifies</text>
    </g>
    <rect x="350.5" y="125" width="120" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="11.999999999999998px">
      <text x="410" y="159.5">Model</text>
    </g>
  </g>
</svg>
</p>

<p><strong>Model</strong> responsibilities:</p>

<ul>
  <li>Business logic</li>
  <li>Accessing and manipulating data</li>
  <li>Persistence</li>
  <li>Communication/Networking</li>
  <li>Parsing</li>
  <li>Extensions and helper classes</li>
  <li>Communication with models</li>
</ul>

<p>Note: The <code class="language-plaintext highlighter-rouge">Model</code> must not communicate directly with the <code class="language-plaintext highlighter-rouge">View</code>. The <code class="language-plaintext highlighter-rouge">Controller</code> is the link between those</p>

<p><strong>View</strong> responsibilities:</p>

<ul>
  <li>Animations, drawings (<code class="language-plaintext highlighter-rouge">UIView</code>,  <code class="language-plaintext highlighter-rouge">CoreAnimation</code>, <code class="language-plaintext highlighter-rouge">CoreGraphics</code>)</li>
  <li>Show data that controller sends</li>
  <li>Might receive user input</li>
</ul>

<p><strong>Controller</strong> responsibilities:</p>

<ul>
  <li>Exchange data between <code class="language-plaintext highlighter-rouge">View</code> and <code class="language-plaintext highlighter-rouge">Model</code></li>
  <li>Receive user actions and interruptions or signals from the outside the app</li>
  <li>Handles the view life cycle</li>
</ul>

<h4 id="advantages">Advantages</h4>

<ul>
  <li>Simple and usually less code</li>
  <li>Fast development for simple apps</li>
</ul>

<h4 id="disadvantages">Disadvantages</h4>

<ul>
  <li>Controllers coupled views</li>
  <li>Massive <code class="language-plaintext highlighter-rouge">ViewController</code>s</li>
</ul>

<h4 id="communication-between-components">Communication between components</h4>

<ul>
  <li><a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/Devpedia-CocoaApp/TargetAction.html">Delegation</a> pattern</li>
  <li><a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/Devpedia-CocoaApp/TargetAction.html">Target-Action</a> pattern</li>
  <li><a href="https://developer.apple.com/documentation/foundation/nsnotificationcenter">Observer</a> pattern with <code class="language-plaintext highlighter-rouge">NSNotificationCenter</code></li>
  <li><a href="https://developer.apple.com/documentation/swift/using-key-value-observing-in-swift">Observer</a> pattern with <code class="language-plaintext highlighter-rouge">KVO</code></li>
</ul>

<h2 id="model-view-presenter">Model-View-Presenter</h2>

<p>In this design pattern View is implemented with classes <code class="language-plaintext highlighter-rouge">UIView</code> and <code class="language-plaintext highlighter-rouge">UIViewController</code>. The <code class="language-plaintext highlighter-rouge">UIViewController</code> has less responsibilities which are limited to:</p>

<ul>
  <li>Routing/Coordination</li>
  <li>Navigation</li>
  <li>Passing informations via a delegation pattern</li>
</ul>

<h4 id="view">View</h4>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">ExampleController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
	<span class="kd">private</span> <span class="k">let</span> <span class="nv">exampleView</span> <span class="o">=</span> <span class="kt">ExampleView</span><span class="p">()</span>
	<span class="k">override</span> <span class="kd">func</span> <span class="nf">loadView</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">super</span><span class="o">.</span><span class="nf">loadView</span><span class="p">()</span>
		<span class="nf">setup</span><span class="p">()</span>
	<span class="p">}</span>
	<span class="kd">private</span> <span class="kd">func</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">let</span> <span class="nv">presenter</span> <span class="o">=</span> <span class="kt">ExamplePresenter</span><span class="p">(</span><span class="n">exampleView</span><span class="p">)</span>
		<span class="n">exampleView</span><span class="o">.</span><span class="n">presenter</span> <span class="o">=</span> <span class="n">presenter</span>
		<span class="n">exampleView</span><span class="o">.</span><span class="nf">setupView</span><span class="p">()</span>
		<span class="k">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">exampleView</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="presenter">Presenter</h4>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protocol</span> <span class="kt">ExampleViewDelegate</span> <span class="p">{</span>
	<span class="kd">func</span> <span class="nf">updateView</span><span class="p">()</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="kt">ExamplePresenter</span> <span class="p">{</span>
	<span class="kd">private</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">exampleView</span><span class="p">:</span> <span class="kt">ExampleViewDelegate</span><span class="p">?</span>
	<span class="nf">init</span><span class="p">(</span><span class="n">_</span> <span class="nv">exampleView</span><span class="p">:</span> <span class="kt">ExampleViewDelegate</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">self</span><span class="o">.</span><span class="n">exampleView</span> <span class="o">=</span> <span class="n">exampleView</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="advantages-1">Advantages</h4>

<ul>
  <li>Easier to test business logic</li>
  <li>Better separation of responsibilities</li>
</ul>

<h4 id="disadvantages-1">Disadvantages</h4>

<ul>
  <li>Usually not a better choice for smaller projects</li>
  <li>Presenters might become massive</li>
  <li>Controllers still handle navigation. Possible solutions →  extend the pattern with Router or Coordinator.</li>
</ul>

<h4 id="common-layers">Common layers</h4>

<ul>
  <li>Data access layer: <code class="language-plaintext highlighter-rouge">CRUD</code> operations facilitated with <code class="language-plaintext highlighter-rouge">CoreData</code> <code class="language-plaintext highlighter-rouge">Realm</code> etc.</li>
  <li>Services: Classes that interacts with database entities, like retrieve data, transform them into objects.</li>
  <li>Extensions/utils</li>
</ul>

<h2 id="model-view-viewmodel">Model-View-ViewModel</h2>

<p><code class="language-plaintext highlighter-rouge">ViewModel</code> has no references to the view.</p>

<p>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="572px" height="63px" viewBox="-0.5 -0.5 572 63" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2023-11-15T22:26:32.916Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/22.0.3 Chrome/114.0.5735.289 Electron/25.8.4 Safari/537.36&quot; version=&quot;22.0.3&quot; etag=&quot;69OR-mwMNjNfgNuLt2t0&quot; type=&quot;device&quot;&gt;&lt;diagram name=&quot;Page-1&quot; id=&quot;UDvbTf5mp8RW8-KXhH33&quot;&gt;7Vhbb9owFP41vE65kEAfC7TbpG6rVHXrHg0xiVeTEzmmQH/97OSYxLm0bNC1qiYhYX8+5/jynRsM/Olq+1GQLPkCEeUDz4m2A3828DzXDXz1pZEdIo4blEgsWIRYBdywR2oEEV2ziOaWoATgkmU2uIA0pQtpYUQI2NhiS+D2rhmJaQu4WRDeRn+wSCYlOvZGFf6JsjgxO7vhWbmyIkYYb5InJIJNDfIvBv5UAMhytNpOKdevZ96l1LvsWd0fTNBUHqLglQoPhK/xbnguuTOXpZG6O05ByARiSAm/qNCJgHUaUW3RUbNK5gogU6CrwF9Uyh0SSdYSFLSEVE6Bgyi28R0ndIiyMcmlgHvav2Je3EMb5mx6G8JZnKrxQl2fKvUJJ3PKryFnkoG18ECFZIrRq4bAikVRcSkjcI4m9wvKgtjd4YbF5Ke++YfATGdbfIlytjOzLZN3tXFNS80qJT0xOiUZmgGL3xzWYoFQiP5PREyR8lHbC9y9b6mopLCi6mRKRFBOJHuwrROMjngvh6rnQpBdTSADlsq8ZvlaA0oAI9038YpxHp41nPHP5NWgPEGP9tjWHjmOfZ/y1VDriWN4YeMYw4ah8q1bhtSg9rgVVIRcd/j5rfCbEUkUMmdpxNK4MxgLl+1y9qbLzkFKWOkApTl7JPPCiHYrJE5ZDCaDYNYdjOcaT0CwR7VGODr83wdUoTkhi/u4yBdmtxRSuvd0bYRuLW/EHI6nrzJn3bu9U3h35QdGBJbLnB5L8fD1Muw+Uzl2pvKeS1V93tBMt+2E3Jm8C12T/lwr/Xkvkf/cDhc5NgFaHvAE3UGL7tssIpLm/0P5oFAevuFQDlvcfmd0g/1tg107YpeM88YraZouyYpx7evfMpoq/RuS5i/SGfUxckCEoMLQaRRFUyQ3VQPsGkKTWvMbOv1kHRpUo86HH2hCdM+gXU59nNvPGp6qmwvgXLnyM6Q8wUA3X6duV0/Aizt+RV7Gb6C2Nbrw0WlrW5dkm9fu1n50dG0zhaxe3MLT17buNjj0mv10cFA/3f8r4YjUe9bytK8g2ZK9r7qaZ2Shuv4JHqo4CGJXdCkRecHqO37D1dcEQ80HDiq97yHLh/6/y/JqWv3/VPJU/Y3nX/wG&lt;/diagram&gt;&lt;/mxfile&gt;" class="center-image">
  <g>
    <path d="M 220 30 L 130 30 L 128.24 30" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 122.24 30 L 130.24 26 L 128.24 30 L 130.24 34 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="11px">
      <text x="169.95" y="25.41">Data binding</text>
    </g>
    <path d="M 340 15 L 441.76 15" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 447.76 15 L 439.76 19 L 441.76 15 L 439.76 11 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="11px">
      <text x="395.41" y="10.41">Updates</text>
    </g>
    <rect x="220" y="0" width="120" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="279.5" y="34.5">ViewModel</text>
    </g>
    <rect x="0" y="0" width="120" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="59.5" y="27.5">View</text>
      <text x="59.5" y="41.5">+ UIViewController</text>
    </g>
    <path d="M 450 45 L 348.24 45" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 342.24 45 L 350.24 41 L 348.24 45 L 350.24 49 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="11px">
      <text x="394.5" y="40.41">Notifies</text>
    </g>
    <rect x="450" y="0" width="120" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="509.5" y="34.5">Model</text>
    </g>
  </g>
</svg>
</p>

<p>Binding is done using: <code class="language-plaintext highlighter-rouge">Combine Framework</code>, <code class="language-plaintext highlighter-rouge">RxSwift</code>, <code class="language-plaintext highlighter-rouge">Bond</code> or <code class="language-plaintext highlighter-rouge">KVO</code> or using delegation pattern</p>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">Model</code></strong> does same things as in <code class="language-plaintext highlighter-rouge">MVP</code> and <code class="language-plaintext highlighter-rouge">MVC</code>.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">View</code></strong> also is similar, but binds with <code class="language-plaintext highlighter-rouge">ViewModel</code></li>
  <li><strong><code class="language-plaintext highlighter-rouge">ViewModel</code></strong> keeps updated state of the view, and process data for i</li>
</ul>

<h4 id="advantages-2">Advantages</h4>

<ul>
  <li>Better reparation of responsibilities</li>
  <li>Better testability, without needing to take into account the views</li>
</ul>

<h4 id="disadvantages-2">Disadvantages</h4>

<ul>
  <li>Might be slower and introduce dependency on external libraries</li>
  <li>Harder to learn and can become complex</li>
</ul>

<h4 id="extension-with-coordinator-mvvm-c"><strong>Extension with Coordinator MVVM-C</strong></h4>

<p>Role of <code class="language-plaintext highlighter-rouge">Coordinator</code> is to manage navigation flow.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protocol</span> <span class="kt">Coordinator</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">navigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span> <span class="p">{</span> <span class="k">get</span> <span class="k">set</span> <span class="p">}</span>
    <span class="kd">func</span> <span class="nf">start</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>

<p>and an example implementation</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">ExampleCoordinator</span><span class="p">:</span> <span class="kt">Coordinator</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">navigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span>
    <span class="nf">init</span><span class="p">(</span><span class="nv">navigationController</span><span class="p">:</span> <span class="kt">UINavigationController</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">navigationController</span> <span class="o">=</span> <span class="kt">UINavigationController</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">start</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">viewModel</span> <span class="o">=</span> <span class="kt">ExampleViewModel</span><span class="p">(</span><span class="nv">someService</span><span class="p">:</span> <span class="kt">SomeService</span><span class="p">(),</span>
                                         <span class="nv">coordinator</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
        <span class="n">navigationController</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="kt">ExampleController</span><span class="p">(</span><span class="n">viewModel</span><span class="p">),</span>
                                                <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">showList</span><span class="p">(</span><span class="n">_</span> <span class="nv">list</span><span class="p">:</span> <span class="kt">ExampleListModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">listCoordinator</span> <span class="o">=</span> <span class="kt">ListCoordinator</span><span class="p">(</span><span class="nv">navigationController</span><span class="p">:</span> <span class="n">navigationController</span>
                                              <span class="nv">list</span><span class="p">:</span> <span class="n">list</span><span class="p">)</span>
        <span class="n">listCoordinator</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In the book I am reading the author created an <code class="language-plaintext highlighter-rouge">ExampleCoordinatorProtocol</code> with a <code class="language-plaintext highlighter-rouge">func showList(_ list: ExampleListModel)</code> where the <code class="language-plaintext highlighter-rouge">ExampleCoordinator</code> implemented it. I think it does not make any sense, however if we might want to inject the coordinator then we might want to relay on an abstraction.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">scene</span><span class="p">(</span><span class="n">_</span> <span class="nv">scene</span><span class="p">:</span> <span class="kt">UIScene</span><span class="p">,</span>
           <span class="n">willConnectTo</span> <span class="nv">session</span><span class="p">:</span> <span class="kt">UISceneSession</span><span class="p">,</span>
           <span class="n">options</span> <span class="nv">connectionOptions</span><span class="p">:</span> <span class="kt">UIScene</span><span class="o">.</span><span class="kt">ConnectionOptions</span><span class="p">)</span> <span class="p">{</span>
    
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">scene</span> <span class="o">=</span> <span class="p">(</span><span class="n">scene</span> <span class="k">as?</span> <span class="kt">UIWindowScene</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
    
    <span class="k">let</span> <span class="nv">window</span> <span class="o">=</span> <span class="kt">UIWindow</span><span class="p">(</span><span class="nv">windowScene</span><span class="p">:</span> <span class="n">scene</span><span class="p">)</span>
    <span class="k">let</span> <span class="nv">navigationController</span> <span class="o">=</span> <span class="kt">UINavigationController</span><span class="p">()</span>
    <span class="n">exampleCoordinator</span> <span class="o">=</span> <span class="kt">ExampleCoordinator</span><span class="p">(</span><span class="nv">navigationController</span><span class="p">:</span> <span class="n">navigationController</span><span class="p">)</span>
    <span class="n">exampleCoordinator</span><span class="p">?</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>
    <span class="n">window</span><span class="o">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="n">navigationController</span>
    <span class="n">window</span><span class="o">.</span><span class="nf">makeKeyAndVisible</span><span class="p">()</span>
    <span class="k">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">window</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="viper">VIPER</h2>

<p>
 <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="602px" height="221px" viewBox="-0.5 -0.5 602 221" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2023-11-15T22:24:54.105Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/22.0.3 Chrome/114.0.5735.289 Electron/25.8.4 Safari/537.36&quot; version=&quot;22.0.3&quot; etag=&quot;y-M79igm0DH8BH6Jtz25&quot; type=&quot;device&quot;&gt;&lt;diagram name=&quot;Page-1&quot; id=&quot;7r8acp36S0mCuLvdL9dW&quot;&gt;7Vptb+I4EP41+bjITkiAjwW6tyvt6qqr7m770QUD3oYYOeZtf/3ZxM6LnUAoIfTalSoVj+2J/czM48k4jjda7v5gaLX4Tqc4dFww3Tne2HFdCH1P/JOSvZIA6CeSOSNTJcsEj+QX1gOVdE2mOC4M5JSGnKyKwgmNIjzhBRlijG6Lw2Y0LD51hebYEjxOUGhL/yVTvkikfbeXyb9gMl/oJ8NgkPQskR6sdhIv0JRucyLv3vFGjFKe/FruRjiU6GlcknmfK3rThTEc8ToT3GTCBoVrtbe/6JpjplbH93rLjK6jKZazgOMNZyQMRzSkTLQjGmEpohH/jJYklEb9c4UjMf8RRbHq0qMd1wMgAEhoGsac0Rdc3aOxdZWOR7UctcsNZhzvKjcOUziFI2K6xJztxRA1oQuUBbQPuj0l2GYWhdpMi5w1PSVDyonmqe4MZ/FDQV0Ou2fB/g/BW8cNBAhQAuy44g/8/VWKR2LrjIbhaascMUG5wZq1ilx284YBg5qG8RswTNeCGE9F6KsmZXxB5zRC4X0mHRaNkI35RulK4fITc75XPIbWnArRgi9D1VtiibtxKd6ltjmMFeiy/Q+1hkPjSTY6vm6Od/nO8V61kv3KTRbpFLE55gWOqGFChkPEyaaoqswcauoDJUJjanrYN2PSjLWYrtkEq2l5WjM0edDQ5HUNTckGLU13jKF9bthKDojPWXLfN/wtUZl5X4pXLYf0LaZ4YDgWhpBsAOhWRLfAXXE2IFI+QxNc6sbf0LM4ib0hCsk8EuJJosYbyoAl4ni7Ux3PlHO6lK6NY/ILPR+USG9RcAiN/tDxxybnfMHhBktNR5z6QBlJJAwOwcOFy9BIPSCUSxyiycv8EFUGZVXSizro1Uqz4zXvs92jtAM6bj+Zc6ETf4LGFDqbxZg7Jgmd5wbB/5aXdoQfaKnT81XzSROR+J2xkmycIKUk+lWy1RYppb6kIxyaVFKXlKyTDZr01hApud2KBzVFSr2jpLRAkpO2GL3IMYe85jcZGb4anCAjGFxGRo2ST/+Yud9/Rgp9M5zqvioEDWSkg1swf8raecrOGLyctdMUFBZT0N6pHLSJc6bGkQFLctsrHCN1DatT1FxYfZUhhSacWjS6qgy4t8qlVyTPQbMHfaNcqZ2swqrvny27vTpsCa7EltAuaD1itiElb0TvEPvAM7GHNvaDK9W0oF3U+kjQByb0fovQdy3o7yNO+P5DIp+eGW0gb9dnPhDyJt2kFN4G8oGFvJ0bRdM7ed0jU6IQxTGZHKBBjNviXPZbNFV5LlwzFT6zGttWJqygymfC2pNrmD9nXb/Eulp2YeGla5RW+9Dwmrp1F99w056ZaDRUdgms+o4Pji7MmuCCcycUn3BxYQfalZ3fQVU3qLySoOq+saAK7NKg/7qosjTpm4+rh5URJZc7vV3fquf01d5dUQm5oacWvLL+Sd+SV1aZ+HyvNKv1rnlqVHjla/zmpqW5T6ADQOFKpeMC9yiBNnWf84AZETjJCpNBzB3XL3j8CX+vwaolpNra1Y91uQuDV5KlpQlcKQexl9wwWer4sj5d0XfR1VcDb7VS2d6tD6yoXOqr48svoRutZabxeBOCg0Vuq5kbSlqEg+KxK3KVE0R0aJm01lLe2L/ogG78WkInP8e/ODlS036rYX7FuG76/Gk2ir1bRnH2UveU63n1Zx8lhQu3tVgRzezL3MQS2QfO3v1/&lt;/diagram&gt;&lt;/mxfile&gt;" class="center-image">
  <g>
    <rect x="250" y="182" width="120" height="30" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="309.5" y="201.5">Router</text>
    </g>
    <rect x="250" y="2" width="120" height="50" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="309.5" y="24.5">View</text>
      <text x="309.5" y="38.5">+ UIViewController</text>
    </g>
    <path d="M 30 142 L 30 197 L 241.76 197" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 247.76 197 L 239.76 201 L 241.76 197 L 239.76 193 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="9px">
      <text x="140.32" y="192.41">Presenter owns router interface</text>
    </g>
    <path d="M 90 82 L 90 42 L 241.76 42" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 247.76 42 L 239.76 46 L 241.76 42 L 239.76 38 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="9px">
      <text x="166.32" y="37.41">Presenter has weak view</text>
    </g>
    <rect x="0" y="82" width="120" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="59.5" y="116.5">Presenter</text>
    </g>
    <path d="M 320 127 L 128.24 127" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 122.24 127 L 130.24 123 L 128.24 127 L 130.24 131 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="9px">
      <text x="219.95" y="122.41">Interactor has weak presenter</text>
    </g>
    <rect x="320" y="82" width="100" height="60" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="369.5" y="116.5">Interactor</text>
    </g>
    <rect x="480" y="22" width="90" height="30" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="524.5" y="41.5">Service</text>
    </g>
    <rect x="510" y="62" width="90" height="30" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="554.5" y="81.5">Service</text>
    </g>
    <rect x="510" y="132" width="90" height="30" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="554.5" y="151.5">Entity</text>
    </g>
    <rect x="480" y="172" width="90" height="30" fill="none" stroke="#0060ad" stroke-width="2" pointer-events="all" />
    <g fill="#0060ad" font-family="Open Sans" font-weight="bold" text-anchor="middle" font-size="12px">
      <text x="524.5" y="191.5">Entity</text>
    </g>
    <path d="M 473.67 42.27 L 450 62 L 450 112 L 450 162 L 473.67 181.73" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 478.28 38.43 L 474.7 46.63 L 473.67 42.27 L 469.58 40.48 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <path d="M 478.28 185.57 L 469.58 183.52 L 473.67 181.73 L 474.7 177.37 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <path d="M 502.89 81.15 L 450 112 L 502.89 142.85" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 508.07 78.13 L 503.17 85.61 L 502.89 81.15 L 499.14 78.7 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <path d="M 508.07 145.87 L 499.14 145.3 L 502.89 142.85 L 503.17 138.39 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <path d="M 450 112 L 428.24 112" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 422.24 112 L 430.24 108 L 428.24 112 L 430.24 116 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <path d="M 249.4 12.1 L 30 12.09 L 30 73.76" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 30 79.76 L 26 71.76 L 30 73.76 L 34 71.76 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="9px">
      <text x="144.81" y="7.5">View owns Presenter</text>
    </g>
    <path d="M 120 97 L 220 97 L 309.86 97.77" fill="none" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke" />
    <path d="M 315.86 97.82 L 307.83 101.75 L 309.86 97.77 L 307.9 93.75 Z" fill="#0060ad" stroke="#0060ad" stroke-width="2" stroke-miterlimit="10" pointer-events="all" />
    <g fill="#0060AD" font-family="Helvetica" text-anchor="middle" font-size="9px">
      <text x="219.05" y="92.41">Presenter owns Interactor</text>
    </g>
  </g>
</svg>
</p>

<h4 id="view-1">View</h4>

<p>It includes <code class="language-plaintext highlighter-rouge">UIViewController</code></p>

<ul>
  <li>Made only to preserve elements like Buttons Labels</li>
  <li>It sends informations to presenters, and receive messages what to show and knows how</li>
</ul>

<h4 id="interactor">Interactor</h4>

<ul>
  <li>Receives informations form databases, servers etc.</li>
  <li>The book says that the Interactor receive actions from presenter, and returns the result via Delegation Pattern.</li>
  <li>The interactor never sends entities to the Presenter</li>
</ul>

<h4 id="presenter-1">Presenter</h4>

<ul>
  <li>Is in the centre and serves as a link</li>
  <li>Process events from the view and requests data from the Interctor. It receives that as primitives, never Entities.</li>
  <li>it handles navigation to the other screens using the Router</li>
</ul>

<h4 id="entity">Entity</h4>

<ul>
  <li>Simple models usually data structures</li>
  <li>They can only be used by the Interactor</li>
</ul>

<h4 id="router">Router</h4>

<ul>
  <li>Creates screens</li>
  <li>Handles navigation, but itself does not know where to go to.</li>
  <li><em>The book says it is the owner of the <code class="language-plaintext highlighter-rouge">UINavigationController</code> and UIViewController, but it is contrary to other parts of the book, so I do not know</em></li>
  <li>Similar to <code class="language-plaintext highlighter-rouge">Coordinator</code> form MVVM-C</li>
</ul>

<!--
https://github.com/ochococo/Design-Patterns-In-Swift

https://nalexn.github.io/clean-architecture-swiftui/
https://medium.com/@vladislavshkodich/architectures-comparing-for-swiftui-6351f1fb3605

-->

<p><strong><code class="language-plaintext highlighter-rouge">Entity.swift</code></strong></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">User</span><span class="p">:</span> <span class="kt">Codable</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">Interactor.swift</code></strong></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">enum</span> <span class="kt">FetchError</span><span class="p">:</span> <span class="kt">Error</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">failed</span>
<span class="p">}</span>

<span class="kd">protocol</span> <span class="kt">AnyInteractor</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">presenter</span><span class="p">:</span> <span class="kt">AnyPresenter</span><span class="p">?</span> <span class="p">{</span> <span class="k">get</span> <span class="k">set</span> <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">getUsers</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">UserInteractor</span><span class="p">:</span> <span class="kt">AnyInteractor</span> <span class="p">{</span>
    <span class="kd">@Injected</span><span class="p">(\</span><span class="o">.</span><span class="n">usersRepository</span><span class="p">)</span> <span class="k">var</span> <span class="nv">usersRepository</span><span class="p">:</span> <span class="kt">AnyUsersRepository</span>
    
    <span class="k">var</span> <span class="nv">presenter</span><span class="p">:</span> <span class="kt">AnyPresenter</span><span class="p">?</span>
    
    <span class="kd">func</span> <span class="nf">getUsers</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">usersRepository</span><span class="o">.</span><span class="n">getUsers</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="k">in</span> <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">presenter</span><span class="p">?</span><span class="o">.</span><span class="nf">interactorDidFetchUsers</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">Presenter.swift</code></strong></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protocol</span> <span class="kt">AnyPresenter</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">router</span><span class="p">:</span> <span class="kt">AnyRouter</span><span class="p">?</span> <span class="p">{</span> <span class="k">get</span> <span class="k">set</span> <span class="p">}</span>
    <span class="k">var</span> <span class="nv">interactor</span><span class="p">:</span> <span class="kt">AnyInteractor</span><span class="p">?</span> <span class="p">{</span> <span class="k">get</span> <span class="k">set</span> <span class="p">}</span>
    <span class="k">var</span> <span class="nv">view</span><span class="p">:</span> <span class="kt">AnyView</span><span class="p">?</span> <span class="p">{</span> <span class="k">get</span> <span class="k">set</span> <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">interactorDidFetchUsers</span><span class="p">(</span><span class="n">with</span> <span class="nv">result</span><span class="p">:</span> <span class="kt">Result</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">User</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">UserPresenter</span><span class="p">:</span> <span class="kt">AnyPresenter</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">interactorDidFetchUsers</span><span class="p">(</span><span class="n">with</span> <span class="nv">result</span><span class="p">:</span> <span class="kt">Result</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">User</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
        <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">users</span><span class="p">):</span>
            <span class="n">view</span><span class="p">?</span><span class="o">.</span><span class="nf">update</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">users</span><span class="p">)</span>
        <span class="k">case</span> <span class="kd">let</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
            <span class="n">view</span><span class="p">?</span><span class="o">.</span><span class="nf">update</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">var</span> <span class="nv">router</span><span class="p">:</span> <span class="kt">AnyRouter</span><span class="p">?</span>
    
    <span class="k">var</span> <span class="nv">interactor</span><span class="p">:</span> <span class="kt">AnyInteractor</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="n">interactor</span><span class="p">?</span><span class="o">.</span><span class="nf">getUsers</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">var</span> <span class="nv">view</span><span class="p">:</span> <span class="kt">AnyView</span><span class="p">?</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">Router.swift</code></strong></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">typealias</span> <span class="kt">EntryPoint</span> <span class="o">=</span> <span class="kt">AnyView</span> <span class="o">&amp;</span> <span class="kt">UIViewController</span>

<span class="kd">protocol</span> <span class="kt">AnyRouter</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">entry</span><span class="p">:</span> <span class="kt">EntryPoint</span><span class="p">?</span> <span class="p">{</span> <span class="k">get</span> <span class="p">}</span>
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">start</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">AnyRouter</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">UserRouter</span><span class="p">:</span> <span class="kt">AnyRouter</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">entry</span><span class="p">:</span> <span class="kt">EntryPoint</span><span class="p">?</span>
    
    
    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">start</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">AnyRouter</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">router</span> <span class="o">=</span> <span class="kt">UserRouter</span><span class="p">()</span>
        
        <span class="k">var</span> <span class="nv">view</span><span class="p">:</span> <span class="kt">AnyView</span> <span class="o">=</span> <span class="kt">UserViewController</span><span class="p">()</span>
        <span class="k">var</span> <span class="nv">presenter</span><span class="p">:</span> <span class="kt">AnyPresenter</span> <span class="o">=</span> <span class="kt">UserPresenter</span><span class="p">()</span>
        <span class="k">var</span> <span class="nv">interactor</span><span class="p">:</span> <span class="kt">AnyInteractor</span> <span class="o">=</span> <span class="kt">UserInteractor</span><span class="p">()</span>
        
        <span class="n">view</span><span class="o">.</span><span class="n">presenter</span> <span class="o">=</span> <span class="n">presenter</span>
        
        <span class="n">interactor</span><span class="o">.</span><span class="n">presenter</span> <span class="o">=</span> <span class="n">presenter</span>
        
        <span class="n">presenter</span><span class="o">.</span><span class="n">router</span> <span class="o">=</span> <span class="n">router</span>
        <span class="n">presenter</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">view</span>
        <span class="n">presenter</span><span class="o">.</span><span class="n">interactor</span> <span class="o">=</span> <span class="n">interactor</span>
        
        <span class="n">router</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">view</span> <span class="k">as?</span> <span class="kt">EntryPoint</span>
        
        <span class="k">return</span> <span class="n">router</span>
    <span class="p">}</span>
<span class="p">}</span>



<span class="c1">//There are a few retain cycles with view, presenter, router and interactor. One option you can do is to make those protocols conforms to AnyObject, and mark these references as "weak":</span>
<span class="c1">//1. router's ref to presenter</span>
<span class="c1">//2. router's ref to view</span>
<span class="c1">//3. presenter's ref to view</span>
<span class="c1">//4. interactor's ref to presenter</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">View.swift</code></strong></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protocol</span> <span class="kt">AnyView</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">presenter</span><span class="p">:</span> <span class="kt">AnyPresenter</span><span class="p">?</span> <span class="p">{</span> <span class="k">get</span> <span class="k">set</span> <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">update</span><span class="p">(</span><span class="n">with</span> <span class="nv">users</span><span class="p">:</span> <span class="p">[</span><span class="kt">User</span><span class="p">])</span>
    <span class="kd">func</span> <span class="nf">update</span><span class="p">(</span><span class="n">with</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">UserViewController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="kt">AnyView</span> <span class="p">{</span>
    
    
    <span class="k">var</span> <span class="nv">presenter</span><span class="p">:</span> <span class="kt">AnyPresenter</span><span class="p">?</span>
    
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">tableView</span> <span class="o">=</span> <span class="kt">UITableView</span><span class="p">()</span>
        <span class="n">tableView</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="kt">UITableViewCell</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forCellReuseIdentifier</span><span class="p">:</span> <span class="s">"cell"</span><span class="p">)</span>
        <span class="n">tableView</span><span class="o">.</span><span class="n">isHidden</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">return</span> <span class="n">tableView</span>
    <span class="p">}()</span>
    
    <span class="k">var</span> <span class="nv">users</span> <span class="o">=</span> <span class="p">[</span><span class="kt">User</span><span class="p">]()</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">tableView</span><span class="p">)</span>
        <span class="n">tableView</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
        <span class="n">tableView</span><span class="o">.</span><span class="n">dataSource</span> <span class="o">=</span> <span class="k">self</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLayoutSubviews</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLayoutSubviews</span><span class="p">()</span>
        <span class="n">tableView</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">bounds</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">update</span><span class="p">(</span><span class="n">with</span> <span class="nv">users</span><span class="p">:</span> <span class="p">[</span><span class="kt">User</span><span class="p">])</span> <span class="p">{</span>
        <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
            <span class="k">self</span><span class="o">.</span><span class="n">users</span> <span class="o">=</span> <span class="n">users</span>
            <span class="k">self</span><span class="o">.</span><span class="n">tableView</span><span class="o">.</span><span class="nf">reloadData</span><span class="p">()</span>
            <span class="k">self</span><span class="o">.</span><span class="n">tableView</span><span class="o">.</span><span class="n">isHidden</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">update</span><span class="p">(</span><span class="n">with</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">extension</span> <span class="kt">UserViewController</span><span class="p">:</span> <span class="kt">UITableViewDelegate</span><span class="p">,</span> <span class="kt">UITableViewDataSource</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">numberOfRowsInSection</span> <span class="nv">section</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
        <span class="n">users</span><span class="o">.</span><span class="n">count</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="n">_</span> <span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">cellForRowAt</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UITableViewCell</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"cell"</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">textLabel</span><span class="p">?</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">users</span><span class="p">[</span><span class="n">indexPath</span><span class="o">.</span><span class="n">row</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="n">cell</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<!--
RIBs
https://github.com/uber/RIBs
https://medium.com/swlh/ios-architecture-exploring-ribs-3db765284fd8
https://github.com/uber/RIBs/wiki
-->

<!--
redux
https://medium.com/mackmobile/getting-started-with-redux-in-swift-54e00f323e2b
-->

<!-- 

# Factory

```swift
protocol ImageReader {
    func getDecodeImage() -> DecodedImage
}

class DecodedImage {
    private var image: String

    init(image: String) {
        self.image = image
    }

    var description: String {
        "\(image): is decoded"
    }
}

class GifReader: ImageReader {
    private var decodedImage: DecodedImage

    init(image: String) {
        self.decodedImage = DecodedImage(image: image)
    }

    func getDecodeImage() -> DecodedImage {
        decodedImage
    }
}

class JpegReader: ImageReader {
    private var decodedImage: DecodedImage

    init(image: String) {
        decodedImage = DecodedImage(image: image)
    }

    func getDecodeImage() -> DecodedImage {
        decodedImage
    }
}

func runFactoryExample() {
    let reader: ImageReader
    let format = "gif"
    let image = "example image"

    switch format {
    case "gif":
        reader = GifReader(image: image)
    default:
        reader = JpegReader(image: image)
    }
    
    let decodedImage = reader.getDecodeImage()
    print(decodedImage.description)
}
```


```swift

protocol Observer<ValueType> {
    associatedtype ValueType
    func update(value: ValueType)
}

struct Subject<T> {    
    private var observers: [(T) -> Void] = []
    
    mutating func attach<O: Observer>(observer: O) where O.ValueType == T {
        observers.append { observer.update(value: $0) }
    }

    func notyfi(value: T) {
        for observer in observers {
            observer(value)
        }
    }
}

class ConcreteObserver: Observer {
    func update(value: String) {
        print("received: \(value)")
    }
}

func runObserverExample() {
    var subject = Subject<String>()

    let observer1 = ConcreteObserver()
    subject.attach(observer: observer1)

    let observer2 = ConcreteObserver()
    subject.attach(observer: observer2)
    
    subject.notyfi(value: "some string")
}

// Version with more modern syntax
/*
protocol Observer<ValueType> {
    associatedtype ValueType
    func update(value: ValueType)
}

struct Subject<T> {
    private var observers = Array<any Observer<T>>()

    mutating func attach(observer: any Observer<T>) {
        observers.append(observer)
    }

    func notify(value: T) {
        for observer in observers {
            observer.update(value: value)
        }
    }
}
*/

```
-->


</div>

          
       <div class="footer">
          <div class="disclaimer">
  <p>
  © Artur Gurgul, 2024 &mdash; Public Domain Licence
  </p>
</div>

        </div>
      </div>
    </div>
  </div>
</body>
</html>
