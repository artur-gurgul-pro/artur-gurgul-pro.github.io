---
layout: post
title:  "Vim notes"
categories: software
---

#### Symbols and meanings
- `%` &rarr; current file. An example:  `:so %` &rarr; Source the current file
- `$` &rarr; end of line

Entering `!!` in normal mode is translated to  `:.!` I. e. Typing `!!date` in normal mode replaces current line with the date.

#### Tips

- `:e[dit]` &rarr;	Edit the current file. This is useful to re-edit the current file, when it has been changed outside of Vim. `:e!` Force reload file

#### Navigation

- `h`  `j`  `k`  `l` &rarr; left, down, up, right
- `*` &rarr; Next whole word under cursor (previous `#`)
- `e` &rarr; Forward to the end of word. `E` can contain punctuation
- `b` &rarr; Jump backwards to the start of a word. `B` can contain punctuation
-  `{`,`}` &rarr; Jump by paragraphs
- `(`,`)` &rarr; Jump by sentences
- `G` &rarr; Jump to the end of the file
* `1G` &rarr; Jump to the beginning of the file (same as `gg`)
* `50G` &rarr; Jump to line 50
- `0` &rarr; Beginning of line
- `_` &rarr; first non-blank character of the line
- `g_`  &rarr; last non-blank character of the line
- `fX` &rarr; next character `X`. `FX` previous

### List of the commands

Common meaning of letters in the commands
- `w` &rarr; word
- `i` &rarr; inner

| Command |  |
| ---: | :--- |
| `dd` |  Delete one line |
| `d` | Delete selection |
| `x` | Delete character under cursor |
| `d+` | Delete 2 lines |
| `:%d` or :`1,$d` |  Delete the whole of the file |
| `dw`, `diw` | Delete what that the cursor is over |
| `di(` | Delete inner brackets|
| `:r[ead] !date` | Execute commend and put content into editor |
| `.` | Repeat the last operation |
| `gU` | Uppercase the selection, `gu`  &rarr; lower |
| `%` | Jump to matching bracket `{ }` `[ ]` `( )` |
| `:%!column -t` | Put text in columns |
| `:%!sort` | Sort the whole file |
| `:'<,'>!grep text` | Keep lines that contains `text` |
| `:'<,'>!sort` | Sort selected lines |
| `:eariler 1m` | State from the 1 min before |
| `ga` | Display hex, ascii value of character under cursor |
| `g8 ` | Display hex value of utf-8 character under cursor |
| `ciw` | Change inner word |
| `yiw`  |  Yank inner word |
| `viwp`  | Select word and then replace it with previously yanked text |
| `rX` |	replace every character in selection or under cursor with `X` |
| `guiw` | Lower case word |
| `guu` | Lowercase line |
| `gUU` | Uppercase line |
|`"1p` | paste from register 1 (works also for yanking) |

#### Status line

```vim
:set statusline=%<%f%h%m%r%=%b\ 0x%B\ \ %l,%c%V\ %P
```

#### Visual Mode

- `V` &rarr; Selection by lines
- `v` &rarr; Selection follows the cursor
- `Ctrl+v` &rarr;  Block selection

#### Enter Insert Mode

- `I` &rarr; At the first non white character of the line
- `i` &rarr; On the left of the cursor
- `A` &rarr; At the very end of the line
- `a` &rarr; On the right of the cursor
- `c` &rarr;  Delete selection and enter insert mode
- `o` &rarr; Create new line below and enter insert mode
- `O` &rarr; Create new line above and enter insert mode

#### Split the editor

- `:sp <filename>` &rarr; Vertically
- `:vs <filename>` &rarr; Horizontally

#### Markers

-  `:marks` &rarr;  list of marks 
- `ma` &rarr; set current position for mark `a`
- `` `a`` &rarr; jump to position of mark `a`
- ``y`a`` &rarr; yank text to position of mark `a` 
*  ``` `` ``` &rarr; Return to the cursor position before the latest jump
* `` `.``  &rarr; Jump to the last changed line.

### Recording macros

1. `qa` &rarr; Start recording macro under letter `a`
2. `q` &rarr; Stop recording 
3. `@a` &rarr; Play the macro saved under letter a
4. `@@` &rarr; Play the last macro

#### Searching

- `:%s/Plug.*$//` &rarr; Search and delete all lines that starts from Plug
- `:%s/foo/bar/gc` &rarr; Replace all occurrence of foo by bar with confirmation
- `/pattern` &rarr; search for pattern then enter and `n` next `N` previous match
- `?pattern` &rarr; search backward for pattern

### Registers

- `:reg` &rarr; print all registers
- `"ap` &rarr; paste the register `a` , if the macro is recorded then it will paste it
- `"xy` &rarr; yank into register `x` 
- `:let @a = "kkll"` &rarr; set a macro from the command mode
- `:%normal @a`  &rarr; execute the macro on all lines of the current file
- `:'<,'>normal @a`  &rarr; execute the macro on a visually selected lines
- `:10,20 normal @a` &rarr; execute the macro for lines from 10 to 20
- `:g/pattern/ normal @a` &rarr; Search for pattern and execute macro for it

#### Functions - An example

Function definition

```vim
function! CalculateAge()
    normal 03wdei^R=2012-^R"^M^[0j 
endfunction
```

Key banding to function

```vim
nnoremap <leader>a :call CalculateAge()<CR>
```

Preloading vim with macros like

```vim
let @a='03wdei^R=2012-^R"^M^[0j'
```

Call function from the command mode

```
:call CalculateAge()
```

#### Configuration

The config file is located at `.config/nvim/init.vim`

```vim
if empty(glob('~/.local/share/nvim/site/autoload/plug.vim'))
  silent !curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs
    \ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
  autocmd VimEnter * PlugInstall --sync | source $MYVIMRC
endif

call plug#begin('~/.vim/plugged')

  Plug 'junegunn/fzf'

  Plug 'neovim/nvim-lspconfig'
  Plug 'neoclide/coc.nvim', {'branch': 'release'}
  
  Plug 'vim-airline/vim-airline'
  Plug 'vim-airline/vim-airline-themes'
  
  Plug 'vim-syntastic/syntastic'
  Plug 'tokorom/syntastic-swiftlint.vim'
  
call plug#end()
```

- `set relativenumber`
- `set encoding=utf-8`
- `syntax on` 
- `map za :FZF<CR>` &rarr; fuzzy finder over `za`

Indentation setup 

- `set tabstop=2 shiftwidth=2 expandtab`
- `filetype plugin indent on`

```vim
let g:syntastic_swift_checkers = ['swiftlint', 'swiftpm']
lua << EOF
  local lspconfig = require('lspconfig')
  lspconfig.sourcekit.setup{}
EOF
```